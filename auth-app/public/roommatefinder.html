<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StayMate - Roommate Finder</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #e76f51;
        --primary-dark: #c8553d;
        --text-primary: #6b4226;
        --text-secondary: #8a7a5a;
        --bg-light: #f5ebe0;
        --bg-card: rgba(227, 213, 202, 0.8);
        --transition-smooth: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      }

      body {
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
        background: var(--bg-light);
        color: var(--text-primary);
        line-height: 1.6;
      }

      .background {
        background: url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQngY8DWaLHqkJCuTkAjCiNa6px0yRcD22K1Q&s")
          no-repeat center center fixed;
        background-size: cover;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: -2;
        transform: scale(1.1);
        animation: slowZoom 30s infinite alternate ease-in-out;
      }

      @keyframes slowZoom {
        0% {
          transform: scale(1);
        }
        100% {
          transform: scale(1.1);
        }
      }

      header {
        width: 100%;
        height: 70px; /* Slightly reduced height for a sleeker look */
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 50px;
        padding: 0 40px;
        position: sticky;
        top: 0;
        z-index: 100;
        transition: all 0.3s ease;
        background-color: rgba(245, 235, 224, 0.85);
        /* Lighter background */
        backdrop-filter: blur(12px);
        box-shadow: 0 2px 10px rgba(107, 66, 38, 0.08);
        border-bottom: 1px solid rgba(231, 111, 81, 0.1); /* Subtle border */
      }

      /* Improved logo styling */
      .logo img {
        width: 160px;
        transition: all 0.3s ease;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
      }

      .logo img:hover {
        transform: scale(1.02);
      }

      /* Enhanced profile icon styling */
      .profile-icon img {
        width: 42px;
        height: 42px;
        cursor: pointer;
        border-radius: 50%;
        transition: all 0.3s ease;
        border: 2px solid var(--primary);
        box-shadow: 0 3px 6px rgba(231, 111, 81, 0.2);
        object-fit: cover;
      }

      .overlay {
        background-color: rgba(255, 255, 255, -0.7);
        backdrop-filter: blur(5px);
        height: 100%;
        width: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
      }

      .logo img {
        width: 180px;
        margin-left: 0;
        transition: var(--transition-smooth);
      }

      .profile-icon {
        position: relative;
      }

      .profile-icon img {
        width: 45px;
        height: 45px;
        cursor: pointer;
        border-radius: 50%;
        transition: var(--transition-smooth);
        border: 2px solid var(--primary);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .profile-icon img:hover {
        transform: scale(1.1) rotate(5deg);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }
      .listings-container {
        display: flex;
        gap: 11px;
        /* width: 100%; */
        padding: 25px;
        border-radius: 10px;
        background: #ffffffb0;
        flex-direction: column;
      }
      .main-content {
        position: relative;
        text-align: center;
        padding-top: 0px;
        max-width: 1200px;
        margin: 0 auto;
      }

      h1 {
        font-size: 46px;
        font-weight: 700;
        margin-bottom: 10px;

        color: var(--primary);
        animation: fadeInUp 1.2s ease-in-out;
        text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
        letter-spacing: -0.5px;
      }

      h2 {
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--text-primary);
        position: relative;
        display: inline-block;
        padding-bottom: 10px;
      }

      h2::after {
        content: "";
        position: absolute;
        width: 60px;
        height: 3px;
        background-color: var(--primary);
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 2px;
      }

      p.section-description {
        font-size: 16px;
        color: var(--text-secondary);
        margin-bottom: 25px;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        line-height: 1.7;
        animation: fadeIn 2s ease-in-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .toggle-buttons {
        margin: 20px 0;
        display: flex;
        justify-content: center;
        gap: 20px;
      }

      .toggle-btn {
        background-color: var(--primary);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 30px;
        cursor: pointer;
        transition: var(--transition-smooth);
        font-size: 15px;
        font-weight: 500;
        box-shadow: 0 4px 10px rgba(231, 111, 81, 0.3);
        margin-bottom: 20px;
      }

      .toggle-btn:hover {
        background-color: var(--primary-dark);
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(231, 111, 81, 0.4);
      }

      .toggle-btn.active {
        background-color: var(--primary-dark);
      }

      .section {
        display: none;
      }

      .section.active {
        display: block;
      }

      .search-filters,
      .room-registration form {
        max-width: 850px;
        margin: 0 auto;
        padding: 25px;
        background-color: var(--bg-card);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        margin-bottom: 50px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        transition: var(--transition-smooth);
        position: relative;
        overflow: hidden;
      }

      .search-filters::before,
      .room-registration form::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: linear-gradient(
          90deg,
          var(--primary),
          #f4a261,
          var(--primary)
        );
        background-size: 200% 100%;
        animation: gradientMove 3s infinite linear;
      }

      @keyframes gradientMove {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      .search-filters:hover,
      .room-registration form:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }

      .form-group {
        position: relative;
        margin-bottom: 5px;
      }

      .form-group i {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
        z-index: 1;
      }

      .search-filters input,
      .search-filters select,
      .room-registration input,
      .room-registration select,
      .room-registration input[type="file"] {
        width: 100%;
        padding: 12px 15px 12px 35px;
        margin: 5px 0;
        border: none;
        border-radius: 10px;
        background-color: rgba(245, 235, 224, 0.9);
        color: var(--text-primary);
        font-size: 14px;
        transition: var(--transition-smooth);
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        font-family: "Poppins", sans-serif;
      }

      .search-filters input:focus,
      .search-filters select:focus,
      .room-registration input:focus,
      .room-registration select:focus,
      .room-registration input[type="file"]:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(231, 111, 81, 0.3),
          inset 0 2px 4px rgba(0, 0, 0, 0.05);
        background-color: rgba(255, 255, 255, 0.95);
      }

      .search-filters input::placeholder,
      .search-filters select,
      .room-registration input::placeholder,
      .room-registration select,
      .room-registration input[type="file"] {
        color: var(--text-secondary);
      }

      .search-filters button,
      .room-registration button {
        background-color: var(--primary);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 30px;
        cursor: pointer;
        transition: var(--transition-smooth);
        font-size: 15px;
        font-weight: 500;
        grid-column: span 2;
        box-shadow: 0 4px 10px rgba(231, 111, 81, 0.3);
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        z-index: 1;
      }

      .search-filters button::before,
      .room-registration button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: 0.5s;
        z-index: -1;
      }

      .search-filters button:hover::before,
      .room-registration button:hover::before {
        left: 100%;
      }

      .search-filters button:hover,
      .room-registration button:hover {
        background-color: var(--primary-dark);
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(231, 111, 81, 0.4);
      }

      .search-filters button:active,
      .room-registration button:active {
        transform: translateY(-1px);
        box-shadow: 0 3px 8px rgba(231, 111, 81, 0.3);
      }

      .roommate-listings {
        max-width: 850px;
        margin: 0 auto;
        padding: 20px;
      }

      .roommate-card {
        background-color: var(--bg-card);
        padding: 25px;
        border-radius: 15px;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        transition: var(--transition-smooth);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
        position: relative;
        overflow: hidden;
        animation: fadeInUp 0.5s ease-out;
      }

      .roommate-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 5px;
        height: 100%;
        background-color: var(--primary);
        transition: var(--transition-smooth);
      }

      .roommate-card:hover::before {
        width: 8px;
      }

      .roommate-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
      }

      .roommate-card img {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        margin-right: 25px;
        object-fit: cover;
        border: 3px solid white;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: var(--transition-smooth);
      }

      .roommate-card:hover img {
        transform: scale(1.05);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .roommate-card .details {
        flex: 1;
      }

      .roommate-card h3 {
        font-size: 22px;
        font-weight: 600;
        margin-bottom: 12px;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .roommate-card h3::after {
        content: "✓";
        display: inline-block;
        background-color: #4caf50;
        color: white;
        width: 20px;
        height: 20px;
        font-size: 12px;
        border-radius: 50%;
        text-align: center;
        line-height: 20px;
      }

      .roommate-card p {
        font-size: 14px;
        color: var(--text-secondary);
        margin: 8px 0;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .roommate-card p i {
        color: var(--primary);
        font-size: 16px;
        width: 20px;
      }

      .roommate-card .contact-btn {
        background-color: var(--primary);
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 30px;
        cursor: pointer;
        transition: var(--transition-smooth);
        margin-left: 20px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 10px rgba(231, 111, 81, 0.3);
      }

      .roommate-card .contact-btn:hover {
        background-color: var(--primary-dark);
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(231, 111, 81, 0.4);
      }

      .roommate-card .contact-btn:active {
        transform: translateY(-1px);
        box-shadow: 0 3px 8px rgba(231, 111, 81, 0.3);
      }

      .no-results {
        text-align: center;
        padding: 40px 20px;
        color: var(--text-secondary);
        font-size: 18px;
        animation: fadeIn 0.5s ease-out;
      }

      .no-results i {
        font-size: 50px;
        color: var(--text-secondary);
        margin-bottom: 15px;
        opacity: 0.5;
      }

      footer {
        background-color: rgba(245, 235, 224, 0.85);

        backdrop-filter: blur(10px);
        padding: 30px 20px;
        text-align: center;
        position: relative;
        margin-top: 60px;
        color: var(--text-primary);
        box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.05);
      }
      .footer-bottom {
        text-align: center;
        color: var(--text-secondary);
        font-size: 14px;
        margin-top: 40px;
        padding-top: 20px;
        border-top: 1px solid rgba(138, 122, 90, 0.2); /* This creates the line */
      }

      .footer-links {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 20px;
      }

      .footer-links a {
        color: var(--text-primary);
        text-decoration: none;
        transition: var(--transition-smooth);
        font-weight: 500;
        position: relative;
      }

      .footer-links a::after {
        content: "";
        position: absolute;
        width: 0;
        height: 2px;
        bottom: -4px;
        left: 0;
        background-color: var(--primary);
        transition: var(--transition-smooth);
      }

      .footer-links a:hover {
        color: var(--primary);
      }

      .footer-links a:hover::after {
        width: 100%;
      }

      .footer-contact {
        margin: 15px 0;
        color: var(--text-primary);
        font-weight: 500;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .footer-contact i {
        color: var(--primary);
      }

      .footer-bottom {
        color: var(--text-secondary);
        font-size: 14px;
        margin-top: 15px;
      }

      /* Loading animation */
      .loading {
        display: none;
        text-align: center;
        padding: 20px;
      }

      .loading-spinner {
        display: inline-block;
        width: 50px;
        height: 50px;
        border: 3px solid rgba(231, 111, 81, 0.3);
        border-radius: 50%;
        border-top-color: var(--primary);
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Success message */
      .success-message {
        display: none;
        background-color: rgba(76, 175, 80, 0.2);
        color: #2e7d32;
        padding: 15px;
        border-radius: 10px;
        margin: 20px auto;
        max-width: 500px;
        text-align: center;
        animation: fadeIn 0.5s ease-out;
        border-left: 4px solid #4caf50;
      }
      button,
      .toggle-btn {
        font-family: "Poppins", sans-serif;
      }

      /* Scroll to top button */
      .scroll-top {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        background-color: var(--primary);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition-smooth);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        z-index: 99;
      }

      .scroll-top.visible {
        opacity: 1;
        visibility: visible;
      }

      .scroll-top:hover {
        background-color: var(--primary-dark);
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
      }

      /* Responsive styles */
      @media (max-width: 768px) {
        header {
          padding: 10px 20px;
          height: 80px;
        }

        .logo img {
          width: 150px;
        }

        h1 {
          font-size: 32px;
        }

        h2 {
          font-size: 24px;
        }

        .search-filters,
        .room-registration form {
          grid-template-columns: 1fr;
          padding: 20px;
        }

        .search-filters button,
        .room-registration button {
          grid-column: span 1;
        }

        .roommate-card {
          flex-direction: column;
          text-align: center;
          padding: 20px;
        }

        .roommate-card img {
          margin-right: 0;
          margin-bottom: 15px;
        }

        .roommate-card .contact-btn {
          margin-left: 0;
          margin-top: 15px;
        }

        .roommate-card p {
          justify-content: center;
        }

        .footer-links {
          flex-direction: column;
          gap: 15px;
        }

        .scroll-top {
          bottom: 20px;
          right: 20px;
          width: 40px;
          height: 40px;
        }

        .toggle-buttons {
          flex-direction: column;
          gap: 15px;
        }
      }

      /* Animations for page elements */
      .animate-fade-in {
        animation: fadeIn 1s ease-out;
      }
      .listing-details {
        /* color: white; */
        padding: 6px;
        box-shadow: crimson;
        display: flex;
        /* shape-outside: content-box; */
        flex-direction: row;
        justify-content: space-around;
        background: #b8b6b5;
        border-radius: 10px;
        align-items: center;
      }
      .animate-fade-in-up {
        animation: fadeInUp 1s ease-out;
      }

      .animate-slide-in-right {
        animation: slideInRight 1s ease-out;
      }

      /* Tooltip styles */
      [data-tooltip] {
        position: relative;
        cursor: help;
      }

      [data-tooltip]::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 125%;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition-smooth);
        z-index: 10;
      }

      [data-tooltip]:hover::after {
        opacity: 1;
        visibility: visible;
      }
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
      }
      .modal-content {
        background-color: white;
        margin: 10% auto;
        padding: 20px;
        width: 50%;
        border-radius: 10px;
      }
      .close {
        float: right;
        font-size: 24px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="background"></div>
    <div class="overlay"></div>

    <header>
      <div class="logo">
        <img src="images/logo.png" alt="StayMate Logo" />
      </div>
      <button
        id="logoutBtn"
        style="
          background-color: rgb(231, 111, 81);
          color: white;
          border: none;
          padding: 7px 17px;
          font-size: 16px;
          font-weight: bold;
          margin-right: 20px;
          border-radius: 10px;
          transition: background 0.3s, transform 0.2s;
          transform: scale(1);
        "
        onmouseover="this.style.backgroundColor='#d63b20'; this.style.transform='scale(1.05)';"
        onmouseout="this.style.backgroundColor='#e76f51'; this.style.transform='scale(1)';"
        onmousedown="this.style.transform='scale(0.95)';"
        onmouseup="this.style.transform='scale(1.05)';"
      >
        Logout
      </button>
      <a href="profilepage.html" class="profile-link">
        <div class="profile-icon">
          <img src="images/profile icon.png" alt="Profile Icon" />
        </div>
      </a>
    </header>

    <div class="main-content">
      <div id="profileModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeProfileModal()">&times;</span>
          <div class="maincont">
            <div class="profile-header">
              <div class="profile-info">
                <h2 id="profile-name">Your Name</h2>
                <p>
                  <i class="fas fa-briefcase"></i>
                  <span id="profile-profession">Your Profession</span>
                </p>
                <p>
                  <i class="fas fa-map-marker-alt"></i>
                  <span id="profile-location">Your Location</span>
                </p>
                <p>
                  <i class="fas fa-envelope"></i>
                  <span id="profile-email">Your Email</span>
                </p>
                <p>
                  <i class="fas fa-phone"></i>
                  <span id="profile-number">Your Number</span>
                </p>
                <div class="profile-completion">
                  <div class="completion-bar"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- <h1 class="animate-fade-in-up">Find Your Perfect Roommate</h1> -->

      <div class="toggle-buttons">
        <button class="toggle-btn active" onclick="showSection('search')">
          Search Rooms
        </button>
        <button class="toggle-btn" onclick="showSection('register')">
          Register Room
        </button>
        <button class="toggle-btn" onclick="showSection('yourlistings')">
          Your Listings
        </button>
      </div>

      <!-- Roommate Search Section -->
      <div class="section search active" id="search-section">
        <p class="section-description">
          Find your ideal roommate by filtering based on location, preferences,
          and lifestyle.
        </p>
        <div class="search-filters animate-fade-in">
          <div class="form-group">
            <i class="fas fa-map-marker-alt"></i>
            <input
              type="text"
              id="location"
              placeholder="Location (e.g., city, neighborhood)"
            />
          </div>
          <div class="form-group">
            <i class="fas fa-smoking"></i>
            <select id="smoking">
              <option value="">Smoking Preference</option>
              <option value="non-smoker">Non-smoker</option>
              <option value="smoker">Smoker</option>
            </select>
          </div>
          <div class="form-group">
            <i class="fas fa-paw"></i>
            <select id="pets">
              <option value="">Pets Preference</option>
              <option value="pet-friendly">Pet-friendly</option>
              <option value="no-pets">No pets</option>
            </select>
          </div>
          <div class="form-group">
            <i class="fas fa-user-friends"></i>
            <select id="lifestyle">
              <option value="">Lifestyle Preferences</option>
              <option value="early-bird">Early Bird</option>
              <option value="night-owl">Night Owl</option>
              <option value="social">Social/Outgoing</option>
              <option value="quiet">Quiet/Reserved</option>
              <option value="vegetarian">Vegetarian</option>
              <option value="non-vegetarian">Non-vegetarian</option>
              <option value="student">Student</option>
              <option value="working">Working Professional</option>
            </select>
          </div>
          <div class="form-group">
            <i class="fas fa-birthday-cake"></i>
            <select id="age">
              <option value="">Age Range</option>
              <option value="18-25">18-25</option>
              <option value="26-35">26-35</option>
              <option value="36-45">36-45</option>
              <option value="46+">46+</option>
            </select>
          </div>
          <div class="form-group">
            <i class="fas fa-rupee-sign"></i>
            <select id="budget">
              <option value="">Budget Range</option>
              <option value="0-5000">₹0 - ₹5,000</option>
              <option value="5001-10000">₹5,001 - ₹10,000</option>
              <option value="10001-15000">₹10,001 - ₹15,000</option>
              <option value="15001+">₹15,000+</option>
            </select>
          </div>
          <button onclick="filterRoommates()">
            <i class="fas fa-search"></i> Find Roommates
          </button>
        </div>

        <!-- Loading indicator -->
        <div id="loading" class="loading">
          <div class="loading-spinner"></div>
          <p>Searching for roommates...</p>
        </div>

        <!-- Roommate Listings -->
        <div class="roommate-listings" id="roommate-listings">
          <!-- Roommate cards will be dynamically added here when searched -->
        </div>
      </div>

      <!-- Room Registration Section -->
      <div class="section register" id="register-section">
        <h2>Have a Room to Share?</h2>
        <p class="section-description">
          Register your room and find the ideal roommate. Share details about
          you and your room below.
        </p>
        <div class="room-registration animate-fade-in">
          <form id="room-registration-form">
            <div class="form-group">
              <i class="fas fa-map-marker-alt"></i>
              <input
                type="text"
                id="room-location"
                placeholder="Location (e.g., city, neighborhood)"
                required
              />
            </div>
            <div class="form-group">
              <i class="fas fa-smoking"></i>
              <select id="room-smoking" required>
                <option value="">Smoking</option>
                <option value="non-smoker">Non-smoker</option>
                <option value="smoker">Smoker</option>
              </select>
            </div>
            <div class="form-group">
              <i class="fas fa-paw"></i>
              <select id="room-pets" required>
                <option value="">Pets</option>
                <option value="pet-friendly">Pet-friendly</option>
                <option value="no-pets">No pets</option>
              </select>
            </div>
            <div class="form-group">
              <i class="fas fa-user-friends"></i>
              <select id="room-lifestyle" required>
                <option value="">Your Lifestyle</option>
                <option value="early-bird">Early Bird</option>
                <option value="night-owl">Night Owl</option>
                <option value="social">Social/Outgoing</option>
                <option value="quiet">Quiet/Reserved</option>
                <option value="vegetarian">Vegetarian</option>
                <option value="non-vegetarian">Non-vegetarian</option>
                <option value="student">Student</option>
                <option value="working">Working Professional</option>
              </select>
            </div>
            <div class="form-group">
              <i class="fas fa-birthday-cake"></i>
              <!-- <select id="age">
                <option value="">Age Range</option>
                <option value="18-25">18-25</option>
                <option value="26-35">26-35</option>
                <option value="36-45">36-45</option>
                <option value="46+">46+</option>
              </select> -->
              <input
                type="number"
                name=""
                placeholder="Enter age"
                id="room-age"
              />
            </div>
            <div class="form-group">
              <i class="fas fa-rupee-sign"></i>

              <input
                type="number"
                name=""
                placeholder="Enter rent"
                id="room-budget"
              />
            </div>
            <div class="form-group">
              <i class="fas fa-image"></i>
              <input type="file" id="room-image" accept="image/*" required />
            </div>
            <button type="submit">
              <i class="fas fa-plus-circle"></i> Register Room
            </button>
          </form>
          <div id="registration-success" class="success-message">
            <i class="fas fa-check-circle"></i> Your room has been successfully
            registered!
          </div>
        </div>
      </div>
      <!-- Your Listings Section -->
      <div class="section your-listings" id="yourlistings-section">
        <h2>Your Listed Rooms</h2>
        <p class="section-description">
          Manage and update your registered rooms here.
        </p>

        <div id="your-listings-container" class="listings-container">
          <!-- Listings will be dynamically added here -->
        </div>

        <div id="no-listings-message" class="no-listings-message">
          <p>You have not listed any rooms yet.</p>
        </div>
      </div>
    </div>

    <div class="scroll-top" id="scrollTop">
      <i class="fas fa-arrow-up"></i>
    </div>

    <footer>
      <div class="footer-links">
        <a href="#">About Us</a>

        <a href="#">Terms of Service</a>
      </div>
      <div class="footer-contact">
        <i class="fas fa-envelope"></i> Contact us: staymate@support.com
      </div>
      <div class="footer-bottom">© 2025 StayMate. All rights reserved.</div>
    </footer>

    <script>
      async function fetchAndPopulateProfile(uid) {
        try {
          console.log(uid);
          const response = await fetch(
            `http://localhost:3000/api/get-user-profile?uid=${uid}`
          );

          if (!response.ok) {
            throw new Error("Failed to fetch user data");
          }

          const userData = await response.json();

          document.getElementById("profile-name").textContent =
            userData.first_name + userData.last_name || "Your Name";
          document.getElementById("profile-profession").textContent =
            userData.profession || "Your Profession";
          document.getElementById("profile-location").textContent =
            userData.address || "Your Location";
          document.getElementById("profile-email").textContent =
            userData.email || "Your Email";
          document.getElementById("profile-number").textContent =
            userData.phone || "Your Number";

          // Profile completion bar logic
          const filledFields = Object.values(userData).filter(
            (value) => value
          ).length;
          const totalFields = 5; // Adjust this if needed
          const completionPercentage = Math.round(
            (filledFields / totalFields) * 100
          );

          const completionBar = document.querySelector(".completion-bar");
          completionBar.style.width = `${completionPercentage}%`;
          completionBar.style.backgroundColor =
            completionPercentage === 100 ? "green" : "orange";
        } catch (error) {
          console.error("Error fetching profile data:", error);
        }
      }
      function openProfileModal(id) {
        document.getElementById("profileModal").style.display = "block";
        fetchAndPopulateProfile(id);
      }
      function closeProfileModal() {
        document.getElementById("profileModal").style.display = "none";
      }
      window.onclick = function (event) {
        if (event.target == document.getElementById("profileModal")) {
          closeProfileModal();
        }
      };
      async function fetchUserListings() {
        try {
          const response = await fetch(
            "http://localhost:3000/api/roomlistings"
          );
          const listings = await response.json();

          const container = document.getElementById("your-listings-container");
          const noListingsMessage = document.getElementById(
            "no-listings-message"
          );

          container.innerHTML = ""; // Clear previous listings

          if (listings.length === 0) {
            noListingsMessage.style.display = "block";
            return;
          } else {
            noListingsMessage.style.display = "none";
          }

          listings.forEach((listing) => {
            const listingCard = document.createElement("div");
            listingCard.classList.add("listing-card");

            listingCard.innerHTML = `
        <div class="listing-details">
          <h3>${listing.location}</h3>
          <p><strong>Budget:</strong> ₹${listing.budget}</p>
          <p><strong>Smoking:</strong> ${listing.smoking}</p>
          <p><strong>Pets:</strong> ${listing.pets}</p>
          <p><strong>Lifestyle:</strong> ${listing.lifestyle}</p>
          <button class="delete-btn" onclick="deleteListing(${listing.id})">
            <i class="fas fa-trash"></i> Delete
          </button>
        </div>
      `;

            container.appendChild(listingCard);
          });
        } catch (error) {
          console.error("Error fetching listings:", error);
        }
      }

      document
        .getElementById("logoutBtn")
        .addEventListener("click", async () => {
          try {
            const response = await fetch("http://localhost:3000/logout", {
              method: "GET",
              credentials: "include", // Ensures session cookie is sent
            });

            const data = await response.json();
            console.log("Logout Response:", data);

            if (response.ok) {
              localStorage.removeItem("user"); // Clear stored user data
              window.location.href = data.redirect; // Redirect to login page
            } else {
              alert("Logout failed: " + data.message);
            }
          } catch (error) {
            console.error("Error during logout:", error);
          }
        });

      async function deleteListing(id) {
        if (!confirm("Are you sure you want to delete this listing?")) return;
        var table = "rooms";
        try {
          const response = await fetch(
            `http://localhost:3000/api/delete-listing/${table}/${id}`,
            {
              method: "DELETE",
            }
          );

          const result = await response.json();
          if (response.ok) {
            alert(result.message);
            // showSuccessMessage
            fetchUserListings(); // Refresh the listings after deletion
          } else {
            alert(result.error);
          }
        } catch (error) {
          console.error("Error deleting listing:", error);
        }
      }
      function showSuccessMessage() {
        const successMessage = document.getElementById("success-message");
        successMessage.classList.add("show");
        setTimeout(() => successMessage.classList.remove("show"), 3000);
      }
      // Toggle section visibility
      function showSection(section) {
        const sections = document.querySelectorAll(".section");
        const buttons = document.querySelectorAll(".toggle-btn");

        sections.forEach((sec) => sec.classList.remove("active"));
        buttons.forEach((btn) => btn.classList.remove("active"));

        document.getElementById(`${section}-section`).classList.add("active");
        document
          .querySelector(`.toggle-btn[onclick="showSection('${section}')"]`)
          .classList.add("active");
      }

      // Show loading indicator
      function showLoading() {
        document.getElementById("loading").style.display = "block";
        document.getElementById("roommate-listings").innerHTML = "";
      }

      // Hide loading indicator
      function hideLoading() {
        document.getElementById("loading").style.display = "none";
      }

      // Function to filter roommate listings with loading effect
      async function filterRoommates() {
        showLoading();

        setTimeout(async () => {
          const location = document
            .getElementById("location")
            .value.toLowerCase();
          const smoking = document.getElementById("smoking").value;
          const pets = document.getElementById("pets").value;
          const lifestyle = document.getElementById("lifestyle").value;
          const age = document.getElementById("age").value;
          const budget = document.getElementById("budget").value;

          const roommateListings = document.getElementById("roommate-listings");
          roommateListings.innerHTML = "";

          try {
            const response = await fetch(
              `http://localhost:3000/api/get-roommates?location=${location}&smoking=${smoking}&pets=${pets}&lifestyle=${lifestyle}&age=${age}&budget=${budget}`
            );

            const rooms = await response.json();
            let matchedRooms = rooms.length;

            rooms.forEach((room, index) => {
              const roommateCard = document.createElement("div");
              roommateCard.className = "roommate-card";
              roommateCard.innerHTML = `
          <img src="${
            room.image_url || "https://via.placeholder.com/90"
          }" alt="Roommate Profile">
          <div class="details">
              <h3>Room Available</h3>
              <p><i class="fas fa-map-marker-alt"></i> <strong>Location:</strong> ${
                room.location
              }</p>
              <p><i class="fas fa-smoking${
                room.smoking === "non-smoker" ? "-ban" : ""
              }"></i> <strong>Smoking:</strong> ${room.smoking}</p>
              <p><i class="fas fa-paw"></i> <strong>Pets:</strong> ${
                room.pets
              }</p>
              <p><i class="fas fa-user-friends"></i> <strong>Lifestyle:</strong> ${
                room.lifestyle
              }</p>
              <p><i class="fas fa-birthday-cake"></i> <strong>Age Range:</strong> ${
                room.age
              }</p>
              <p><i class="fas fa-rupee-sign"></i> <strong>Budget:</strong> ${
                room.budget
              }</p>
          </div>
           <button class="btn" onclick="openProfileModal('${
             room.uid
           }')"><i class="fas fa-comment"></i> Contact</button>
        `;
              roommateListings.appendChild(roommateCard);
            });

            if (matchedRooms === 0) {
              const noResults = document.createElement("div");
              noResults.className = "no-results";
              noResults.innerHTML = `
          <i class="fas fa-search"></i>
          <p>No roommates found matching your criteria.</p>
          <p>Try adjusting your filters for more results.</p>
        `;
              roommateListings.appendChild(noResults);
            }
          } catch (error) {
            console.error("Error fetching roommate listings:", error);
            alert("Error fetching roommate listings. Please try again later.");
          }

          hideLoading();
        }, 1000);
      }

      // Function to contact a roommate
      function contactRoommate(name) {
        alert(`Contacting ${name}...`);
      }

      // Scroll to top functionality
      const scrollTopButton = document.getElementById("scrollTop");

      window.addEventListener("scroll", () => {
        if (window.pageYOffset > 300) {
          scrollTopButton.classList.add("visible");
        } else {
          scrollTopButton.classList.remove("visible");
        }
      });

      scrollTopButton.addEventListener("click", () => {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      });

      // Animate elements when they come into view
      const animateOnScroll = () => {
        const elements = document.querySelectorAll(
          ".roommate-card, h2, .search-filters, .room-registration"
        );

        elements.forEach((element) => {
          const elementPosition = element.getBoundingClientRect().top;
          const screenPosition = window.innerHeight / 1.3;

          if (elementPosition < screenPosition) {
            if (!element.classList.contains("animate-fade-in")) {
              element.classList.add("animate-fade-in");
            }
          }
        });
      };

      window.addEventListener("scroll", animateOnScroll);

      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        animateOnScroll();
        fetchUserListings();

        showSection("search"); // Show search section by default
      });

      // Modify the existing room registration form submit event handler
      document
        .getElementById("room-registration-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const formData = new FormData();
          formData.append(
            "location",
            document.getElementById("room-location").value
          );
          formData.append(
            "smoking",
            document.getElementById("room-smoking").value
          );
          formData.append("pets", document.getElementById("room-pets").value);
          formData.append(
            "lifestyle",
            document.getElementById("room-lifestyle").value
          );
          formData.append("age", document.getElementById("room-age").value);
          formData.append(
            "budget",
            document.getElementById("room-budget").value
          );

          const file = document.getElementById("room-image").files[0];
          if (file) {
            formData.append("image", file);
          }

          // Send data to backend
          sendRoomDataToBackend(formData);
        });

      function sendRoomDataToBackend(formData) {
        // Disable the submit button to prevent multiple submissions
        const submitButton = document.querySelector('button[type="submit"]');
        submitButton.disabled = true;
        submitButton.innerHTML =
          '<i class="fas fa-spinner fa-spin"></i> Registering...';

        fetch("http://localhost:3000/api/register-room", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            console.log("Success:", data);
            alert("Room registered successfully!");
            document.getElementById("room-registration-form").reset();
          })
          .catch((error) => {
            console.error("Error:", error);
            alert(
              "There was an error while registering the room. Please try again."
            );
          })
          .finally(() => {
            // Re-enable the submit button after the request is complete
            submitButton.disabled = false;
            submitButton.innerHTML =
              '<i class="fas fa-plus-circle"></i> Register Room'; // Reset button text
          });
      }

      // Replace the original filterRoommates function with a version that uses the backend

      // Function to contact a roommate with backend integration
      function contactRoommate(roommateId) {
        // Show loading state (optional)
        showLoading();

        // Define your backend API endpoint
        const backendUrl = "http://localhost:3000"; // Replace with your actual backend URL

        // Get user details (you might want to get this from a form or user profile)
        const userContact = {
          name: "User", // Replace with actual user name
          email: "user@example.com", // Replace with actual user email
          message: "I'm interested in your room listing.",
        };

        // Set up the fetch request
        fetch(backendUrl, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            // Add any authentication headers if needed
            // 'Authorization': 'Bearer ' + yourAuthToken
          },
          body: JSON.stringify(userContact),
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error(
                "Network response was not ok: " + response.statusText
              );
            }
            return response.json();
          })
          .then((data) => {
            console.log("Contact request sent:", data);

            // Hide loading indicator
            hideLoading();

            // Show success message
            alert(
              `Contact request sent to ${roommateId}. You'll be notified when they respond.`
            );
          })
          .catch((error) => {
            console.error("Error sending contact request:", error);

            // Hide loading indicator
            hideLoading();

            // Show fallback message
            alert(`Contacting ${roommateId}...`);
          });
      }
    </script>
  </body>
</html>
